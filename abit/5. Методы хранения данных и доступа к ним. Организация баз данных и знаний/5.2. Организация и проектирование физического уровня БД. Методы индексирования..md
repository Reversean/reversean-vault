Физический уровень базы данных отвечает за хранение данных на физическом носителе и за обеспечение их эффективного доступа и управления. Проектирование этого уровня включает выбор структуры хранения, методов индексирования и оптимизации производительности системы.

## Основные аспекты физического уровня БД

1. **Структура хранения данных**:
    
    - **Файловая система**: Данные хранятся в виде файлов на диске.
    - **Страницы данных**: Логические блоки фиксированного размера, в которых хранятся записи.
    - **Записи**: Минимальные единицы хранения данных.
    
2. **Форматы хранения**:
    
    - **Прямой доступ (Heap files)**: Записи добавляются в файл в порядке их поступления.
    - **Последовательный доступ (Sequential files)**: Записи хранятся в отсортированном порядке.
    - **Кластеризованное хранение (Clustered files)**: Записи с одинаковыми значениями ключа хранятся рядом друг с другом.
    
3. **Управление памятью**:
    
    - **Буферный кэш**: Область оперативной памяти для временного хранения данных, извлеченных с диска.
    - **Стратегии управления кэшем**: LRU (Least Recently Used), MRU (Most Recently Used) и другие.
    

## Методы индексирования

Индексы используются для ускорения поиска данных в базе данных. Они создают вспомогательную структуру, которая позволяет быстро находить записи по ключевым полям.

### Основные виды индексов

1. **Хэш-индексы**:
    
    - Используют хэш-функции для преобразования ключей в адреса.
    - Обеспечивают быстрый доступ по точному совпадению ключа.
    - Неэффективны для диапазонных запросов.
    - Пример: поиск записи по идентификатору в большой базе данных.
    
2. **B-деревья (B-Trees)**:
    
    - Самобалансирующиеся деревья, в которых все пути от корня до листьев имеют одинаковую длину.
    - Поддерживают эффективные вставки, удаления и поиска.
    - Подходят для диапазонных запросов.
    - Пример: индексирование по числовым и строковым ключам.
    
3. **B+ деревья (B+ Trees)**:
    
    - Расширение B-деревьев, в котором все данные хранятся только в листьях.
    - Листья связаны между собой, что ускоряет последовательный доступ к данным.
    - Широко используются в СУБД благодаря высокой производительности.
    - Пример: индексирование для операций поиска, вставки и удаления.
    
4. **Bitmap-индексы**:
    
    - Используют битовые карты для представления наличия значений атрибутов.
    - Эффективны для колонок с небольшим числом уникальных значений.
    - Подходят для булевых запросов и сложных логических операций.
    - Пример: индексирование для анализа данных в хранилищах данных.
    
5. **Индексы на основе триграмм (Trigram Indexes)**:
    
    - Используют тройки символов для создания индекса.
    - Эффективны для полнотекстового поиска и поиска по шаблону.
    - Пример: индексирование текста для поиска похожих строк.
    

## Проектирование индексов

1. **Выбор полей для индексирования**:
    
    - **Первичные ключи**: Обычно всегда индексируются для обеспечения уникальности и быстрого доступа.
    - **Внешние ключи**: Индексируются для ускорения операций соединения.
    - **Часто используемые поля в запросах**: Поля, часто используемые в WHERE, JOIN и ORDER BY.
    
2. **Комбинированные индексы (Composite Indexes)**:
    
    - Индексы, охватывающие несколько столбцов таблицы.
    - Обеспечивают более быстрый доступ для запросов, использующих все или часть ключевых полей.
    - Пример: индекс по полям (last_name, first_name) для поиска по фамилии и имени.
    
3. **Управление индексами**:
    
    - **Анализ и оптимизация**: Регулярное обновление статистики и анализ использования индексов для оптимизации запросов.
    - **Удаление ненужных индексов**: Удаление неиспользуемых индексов для уменьшения накладных расходов.
    

## Примеры применения методов индексирования

1. **Торговая платформа**:
    
    - **B+ деревья**: для индексирования товаров по цене и названию.
    - **Bitmap-индексы**: для быстрого поиска товаров по категориям и наличию.
    
2. **Банковская система**:
    
    - **Хэш-индексы**: для поиска клиентов по номеру счета.
    - **Комбинированные индексы**: для ускорения запросов по имени клиента и дате открытия счета.
    